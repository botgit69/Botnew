const { setIntervalAsync } = require("set-interval-async/dynamic");
const moment = require("moment-timezone");

module.exports = {
	config: {
		name: "namaz_auto",
		version: "1.1",
		author: "Tanu Bruh",
		category: "events",
		description: "ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝ ржЗрж╕рж▓рж╛ржорж┐ржХ ржмрж╛рж░рзНрждрж╛, рж╣рж╛ржжрж┐рж╕ ржУ ржжрзЛржпрж╝рж╛ ржкрж╛ржарж╛ржмрзЗ"
	},

	onLoad: function({ api }) {
		console.log("ЁЯХМ Namaz Auto Event with Hadith Loaded Successfully!");

		// ржкрзНрж░рждрж┐ ржорж┐ржирж┐ржЯрзЗ ржЪрзЗржХ ржХрж░ржмрзЗ
		setIntervalAsync(async () => {
			const now = moment().tz("Asia/Dhaka");
			const hour = now.hour();
			const minute = now.minute();

			// ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝
			const namazTimes = [
				{ 
					name: "ржлржЬрж░", hour: 5, minute: 0,
					message: "ЁЯХМ ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!\nржПржЦржи ржлржЬрж░ ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝ред ржЖрж▓рзНрж▓рж╛рж╣рж░ ржжрж┐ржХрзЗ ржорзБржЦ ржлрж┐рж░рж┐ржпрж╝рзЗ ржирж╛ржорж╛ржЬ ржЖржжрж╛ржпрж╝ ржХрж░рзБржиред ЁЯд▓\nЁЯУЦ рж╣рж╛ржжрж┐рж╕: тАЬржпрзЗ ржмрзНржпржХрзНрждрж┐ ржлржЬрж░ ржирж╛ржорж╛ржЬ ржЖржжрж╛ржпрж╝ ржХрж░рзЗ, рж╕рзЗ рждрж╛рж░ ржЗржорж╛ржирзЗрж░ ржкрзБрж░рж╕рзНржХрж╛рж░ ржкрж╛ржмрзЗредтАЭ\nЁЯТЪ ржжрзЛржпрж╝рж╛: тАШ╪з┘Д┘Д┘О┘С┘З┘П┘Е┘О┘С ╪з╪м╪╣┘Д┘Ж╪з ┘Е┘Ж ╪з┘Д╪░╪з┘Г╪▒┘К┘Ж ┘Д┘Г ┘Б┘К ╪з┘Д┘Д┘К┘Д ┘И╪з┘Д┘Ж┘З╪з╪▒тАЩ"
				},
				{ 
					name: "ржЬрзЛрж╣рж░", hour: 12, minute: 15,
					message: "ЁЯХМ ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!\nржПржЦржи ржЬрзЛрж╣рж░ ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝ред ржнржХрзНрждрж┐ ржУ рж╢рж╛ржирзНрждрж┐ ржЕржирзБржнржм ржХрж░рзБржиред ЁЯд▓\nЁЯУЦ рж╣рж╛ржжрж┐рж╕: тАЬржЬрзЛрж╣рж░рзЗрж░ ржирж╛ржорж╛ржЬ ржпрж┐ржирж┐ рж╕ржоржпрж╝ржорждрзЛ ржЖржжрж╛ржпрж╝ ржХрж░ржмрзЗржи, ржЖрж▓рзНрж▓рж╛рж╣ рждрж╛рж░ ржжрж┐ржиржХрзЗ ржЖрж▓рзЛржпрж╝ ржнрж░рж┐ржпрж╝рзЗ ржжрзЗржмрзЗржиредтАЭ\nЁЯТЪ ржжрзЛржпрж╝рж╛: тАШ╪з┘Д┘Д┘О┘С┘З┘П┘Е┘О┘С ╪з╪м╪╣┘Д┘Ж╪з ┘Е┘Ж ╪з┘Д┘Е╪к┘В┘К┘ЖтАЩ"
				},
				{ 
					name: "ржЖрж╕рж░", hour: 15, minute: 45,
					message: "ЁЯХМ ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!\nржПржЦржи ржЖрж╕рж░ ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝ред рж╣рж┐ржпрж╝рж╛рж░рзНржиржд ржУ рж╕рзНржорзГрждрж┐рж╢ржХрзНрждрж┐ ржмрзГржжрзНржзрж┐ ржХрж░рзБржиред ЁЯд▓\nЁЯУЦ рж╣рж╛ржжрж┐рж╕: тАЬржЖрж╕рж░ ржирж╛ржорж╛ржЬ рждрзНржпрж╛ржЧ ржХрж░рж╛ ржкрзНрж░ржорж╛ржг ржпрзЗ ржорж╛ржирзБрж╖ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржкрзНрж░рждрж┐ ржЙржжрж╛рж╕рзАржиредтАЭ\nЁЯТЪ ржжрзЛржпрж╝рж╛: тАШ╪з┘Д┘Д┘О┘С┘З┘П┘Е┘О┘С ╪з╪м╪╣┘Д┘Ж╪з ┘Е┘Ж ╪з┘Д╪╡╪з┘Д╪н┘К┘ЖтАЩ"
				},
				{ 
					name: "ржорж╛ржЧрж░рж┐ржм", hour: 18, minute: 30,
					message: "ЁЯХМ ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!\nржПржЦржи ржорж╛ржЧрж░рж┐ржм ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝ред ржЖрж▓рзНрж▓рж╛рж╣рж░ рж╕рзНржорж░ржгрзЗ рж╕ржоржпрж╝ ржжрж┐ржиред ЁЯд▓\nЁЯУЦ рж╣рж╛ржжрж┐рж╕: тАЬржорж╛ржЧрж░рж┐ржм ржирж╛ржорж╛ржЬ рж╢рзЗрж╖рзЗ рж╕рзВрж░рзНржпрж╛рж╕рзНрждрзЗрж░ ржЖрж▓рзЛ ржоржирзЗрж░ ржЕржирзНржзржХрж╛рж░ ржжрзВрж░ ржХрж░рзЗредтАЭ\nЁЯТЪ ржжрзЛржпрж╝рж╛: тАШ╪з┘Д┘Д┘О┘С┘З┘П┘Е┘О┘С ╪з╪м╪╣┘Д┘Ж╪з ┘Е┘Ж ╪з┘Д┘Е┘И┘Б┘В┘К┘ЖтАЩ"
				},
				{ 
					name: "ржЗрж╢рж╛", hour: 20, minute: 0,
					message: "ЁЯХМ ржЖрж╕рж╕рж╛рж▓рж╛ржорзБ ржЖрж▓рж╛ржЗржХрзБржо!\nржПржЦржи ржЗрж╢рж╛ ржирж╛ржорж╛ржЬрзЗрж░ рж╕ржоржпрж╝ред рж╢рж╛ржирзНрждрж┐ ржУ рж╕ржорж╛ржзрж┐ ржЕржирзБржнржм ржХрж░рзБржиред ЁЯд▓\nЁЯУЦ рж╣рж╛ржжрж┐рж╕: тАЬржЗрж╢рж╛рж░ ржирж╛ржорж╛ржЬ ржЖржжрж╛ржпрж╝ржХрж╛рж░рзА рж░рж╛рждрзЗрж░ ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж▓рж╛ржн ржХрж░рзЗредтАЭ\nЁЯТЪ ржжрзЛржпрж╝рж╛: тАШ╪з┘Д┘Д┘О┘С┘З┘П┘Е┘О┘С ╪з╪м╪╣┘Д┘Ж╪з ┘Е┘Ж ╪з┘Д╪╣╪з╪и╪п┘К┘Ж ┘Д┘ГтАЩ"
				}
			];

			for (const namaz of namazTimes) {
				if (hour === namaz.hour && minute === namaz.minute) {
					try {
						const threads = await api.getThreadList(100, null, ["INBOX"]);
						for (const thread of threads) {
							await api.sendMessage(namaz.message, thread.threadID);
						}
					} catch (err) {
						console.error("тЭМ Error sending namaz message:", err);
					}
				}
			}
		}, 60 * 1000);
	}
};
