const { setIntervalAsync } = require("set-interval-async/dynamic");
const moment = require("moment-timezone");

module.exports = {
	config: {
		name: "birthday_auto",
		version: "1.4",
		author: "Tanu Bruh",
		category: "events",
		description: "ржЬржирзНржоржжрж┐ржи рж░рж╛ржд рззрзи:рзжрзж ржЯрж╛ржпрж╝ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ рж╕ржм ржЧрзНрж░рзБржкрзЗ ржЗржорзЛрж╢ржирж╛рж▓ ржЙржЗрж╢ ржкрж╛ржарж╛ржмрзЗ"
	},

	onLoad: function({ api }) {
		console.log("ЁЯОЙ Birthday Auto Event Loaded Successfully!");

		setIntervalAsync(async () => {
			const now = moment().tz("Asia/Dhaka");
			const day = now.date();
			const month = now.month() + 1; // moment ржорж╛рж╕ 0 ржерзЗржХрзЗ рж╢рзБрж░рзБ
			const hour = now.hour();
			const minute = now.minute();

			// ржпржжрж┐ рзйрзж ржЕржХрзНржЯрзЛржмрж░ рж╢рзБрж░рзБ рж╣ржпрж╝ (рж░рж╛ржд рззрзи:рзжрзж)
			if (day === 30 && month === 10 && hour === 0 && minute === 0) {
				const message = `
ЁЯОЙЁЯОВтЬи *рж╢рзБржн ржЬржирзНржоржжрж┐ржи рждрж╛ржиржнрзАрж░ ржнрж╛ржЗ!* тЬиЁЯОВЁЯОЙ

ЁЯТЦ ржЖржЬржХрзЗрж░ ржжрж┐ржиржЯрж┐ ржЖржкржирж╛рж░ ржЬржирзНржп ржЖрж▓рзНрж▓рж╛рж╣рж░ рж░рж╣ржоржд, ржЖржиржирзНржж ржПржмржВ ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ржпрж╝ ржнрж░рзЗ ржЙржарзБржХред  
ЁЯХКя╕П ржмржирзНржзрзБржмрж╛ржирзНржзржм рж╕ржмрж╛рж░ ржерзЗржХрзЗ рж╣рж╛ржЬрж╛рж░ ржорж╛ржЗрж▓ ржжрзВрж░рзЗ, рждржмрзБ ржХрзЗржЙ ржЙржЗрж╢ ржирж╛ ржХрж░рж▓рзЗржУ ржЖржорж┐ ржХрж░рж▓рж╛ржо тЭдя╕П  
ЁЯУМ @MD Tanvir Ahmmed Chowdhury

ЁЯТФ ржЬрж╛ржирж┐, ржХржЦржирзЛ ржХржЦржирзЛ ржорж╛ржирзБрж╖ ржЖржорж╛ржжрзЗрж░ ржжрзВрж░рждрзНржмрзЗ ржнрж╛ржЩрзЗ, ржоржиржЯрж╛ ржХрж╖рзНржЯрзЗ ржнрж░рзЗ ржпрж╛ржпрж╝ред  
ЁЯМЯ ржХрж┐ржирзНрждрзБ ржЖржЬржХрзЗрж░ ржжрж┐ржирзЗ, ржПржЗ ржХрзНрж╖рзБржжрзНрж░ ржмрж╛рж░рзНрждрж╛ржпрж╝ ржЖржорж╛рж░ ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ ржПржмржВ ржЖржирзНрждрж░рж┐ржХрждрж╛ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ржкрзМржБржЫрзЗред  

ЁЯОБ ржЖржЬржХрзЗрж░ ржжрж┐ржиржЯрж┐ ржЙржжржпрж╛ржкржи ржХрж░рзБржи, рж╣рж╛рж╕рзБржи, ржЖржиржирзНржж ржХрж░рзБржиред  
ЁЯд▓ ржЖрж▓рзНрж▓рж╛рж╣ ржЖржкржирж╛рж░ ржЬрзАржмржиржХрзЗ рж╕рзБржЦ, рж╢рж╛ржирзНрждрж┐, ржЖрж╢рж╛ ржПржмржВ ржирзЗржХ ржЖржорж▓ ржжрж┐ржпрж╝рзЗ ржнрж░рзЗ ржжрж┐ржиред  
тЬи ржЖржкржирж┐ ржХржЦржирзЛ ржПржХрж╛ ржиржи, ржЖржорж┐ рж╕ржмрж╕ржоржпрж╝ ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржЖржЫрж┐ ржПржЗ ржорзЗрж╕рзЗржЬрзЗрж░ ржорж╛ржзрзНржпржорзЗред  

ЁЯТМ ржЖржмрж╛рж░ржУ рж╢рзБржн ржЬржирзНржоржжрж┐ржи, рждрж╛ржиржнрзАрж░ ржнрж╛ржЗ! ЁЯОЙЁЯТЦЁЯОВ
`;

				try {
					const threads = await api.getThreadList(100, null, ["INBOX"]);
					for (const thread of threads) {
						await api.sendMessage(message, thread.threadID);
					}
					console.log("тЬЕ Emotional Birthday message sent to all threads at 12:00 AM Bangladesh Time!");
				} catch (err) {
					console.error("тЭМ Error sending birthday message:", err);
				}
			}
		}, 60 * 1000); // ржкрзНрж░рждрж┐ ржорж┐ржирж┐ржЯрзЗ ржЪрзЗржХ ржХрж░ржмрзЗ
	}
};
